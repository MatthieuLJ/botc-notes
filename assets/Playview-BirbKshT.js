import{i as H,k as W,l as R,m as he,r as y,j as a,n as G,o as N,p as V,q as z,t as Z,v as se,w as pe,x as me,y as fe,a as le,u as _,S as ge,C as T,g as be,z as Q,A as ve,f as xe,R as Ce,h as ye,B as we}from"./index-Okv8gMGM.js";import{b as ke,u as Se,d as ee,f as ie,e as je,B as E,M as ce,I as U,g as oe,F as Ne,h as Re,S as $e,i as Le,c as Pe,P as Te,T as Be,j as Fe,A as J,k as ne}from"./index-DoaENzwb.js";import{T as re,N as Ie,M as P,a as Me}from"./NoteList-CemgqFmr.js";import"./role-BNc36tb4.js";function De(e){return H("PrivateSwitchBase",e)}W("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const _e=e=>{const{classes:t,checked:s,disabled:n,edge:l}=e,u={root:["root",s&&"checked",n&&"disabled",l&&`edge${N(l)}`],input:["input"]};return V(u,De,t)},ze=R(ke)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:t})=>e==="start"&&t.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:t})=>e==="end"&&t.size!=="small",style:{marginRight:-12}}]}),Oe=R("input",{shouldForwardProp:he})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Ae=y.forwardRef(function(t,s){const{autoFocus:n,checked:l,checkedIcon:u,className:i,defaultChecked:h,disabled:m,disableFocusRipple:c=!1,edge:d=!1,icon:g,id:v,inputProps:F,inputRef:o,name:p,onBlur:w,onChange:I,onFocus:O,readOnly:M,required:$=!1,tabIndex:r,type:x,value:b,...K}=t,[B,A]=Se({controlled:l,default:!!h,name:"SwitchBase",state:"checked"}),k=ee(),X=j=>{O&&O(j),k&&k.onFocus&&k.onFocus(j)},D=j=>{w&&w(j),k&&k.onBlur&&k.onBlur(j)},L=j=>{if(j.nativeEvent.defaultPrevented)return;const ae=j.target.checked;A(ae),I&&I(j,ae)};let S=m;k&&typeof S>"u"&&(S=k.disabled);const ue=x==="checkbox"||x==="radio",Y={...t,checked:B,disabled:S,disableFocusRipple:c,edge:d},te=_e(Y);return a.jsxs(ze,{component:"span",className:G(te.root,i),centerRipple:!0,focusRipple:!c,disabled:S,tabIndex:null,role:void 0,onFocus:X,onBlur:D,ownerState:Y,ref:s,...K,children:[a.jsx(Oe,{autoFocus:n,checked:l,defaultChecked:h,className:te.input,disabled:S,id:ue?v:void 0,name:p,onChange:L,readOnly:M,ref:o,required:$,ownerState:Y,tabIndex:r,type:x,...x==="checkbox"&&b===void 0?{}:{value:b},...F}),B?u:g]})});function Ee(e){return H("MuiFormControlLabel",e)}const q=W("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),qe=e=>{const{classes:t,disabled:s,labelPlacement:n,error:l,required:u}=e,i={root:["root",s&&"disabled",`labelPlacement${N(n)}`,l&&"error",u&&"required"],label:["label",s&&"disabled"],asterisk:["asterisk",l&&"error"]};return V(i,Ee,t)},Ge=R("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[{[`& .${q.label}`]:t.label},t.root,t[`labelPlacement${N(s.labelPlacement)}`]]}})(z(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${q.disabled}`]:{cursor:"default"},[`& .${q.label}`]:{[`&.${q.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:t})=>t==="start"||t==="top"||t==="bottom",style:{marginLeft:16}}]}))),Ue=R("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(z(({theme:e})=>({[`&.${q.error}`]:{color:(e.vars||e).palette.error.main}}))),He=y.forwardRef(function(t,s){const n=Z({props:t,name:"MuiFormControlLabel"}),{checked:l,className:u,componentsProps:i={},control:h,disabled:m,disableTypography:c,inputRef:d,label:g,labelPlacement:v="end",name:F,onChange:o,required:p,slots:w={},slotProps:I={},value:O,...M}=n,$=ee(),r=m??h.props.disabled??($==null?void 0:$.disabled),x=p??h.props.required,b={disabled:r,required:x};["checked","name","onChange","value","inputRef"].forEach(S=>{typeof h.props[S]>"u"&&typeof n[S]<"u"&&(b[S]=n[S])});const K=ie({props:n,muiFormControl:$,states:["error"]}),B={...n,disabled:r,labelPlacement:v,required:x,error:K.error},A=qe(B),k={slots:w,slotProps:{...i,...I}},[X,D]=je("typography",{elementType:re,externalForwardedProps:k,ownerState:B});let L=g;return L!=null&&L.type!==re&&!c&&(L=a.jsx(X,{component:"span",...D,className:G(A.label,D==null?void 0:D.className),children:L})),a.jsxs(Ge,{className:G(A.root,u),ownerState:B,ref:s,...M,children:[y.cloneElement(h,b),x?a.jsxs("div",{children:[L,a.jsxs(Ue,{ownerState:B,"aria-hidden":!0,className:A.asterisk,children:["â€‰","*"]})]}):L]})});function We(e){return H("MuiFormGroup",e)}W("MuiFormGroup",["root","row","error"]);const Ve=e=>{const{classes:t,row:s,error:n}=e;return V({root:["root",s&&"row",n&&"error"]},We,t)},Ke=R("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),Xe=y.forwardRef(function(t,s){const n=Z({props:t,name:"MuiFormGroup"}),{className:l,row:u=!1,...i}=n,h=ee(),m=ie({props:n,muiFormControl:h,states:["error"]}),c={...n,row:u,error:m.error},d=Ve(c);return a.jsx(Ke,{className:G(d.root,l),ownerState:c,ref:s,...i})});function Ye(e){return H("MuiSwitch",e)}const f=W("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Je=e=>{const{classes:t,edge:s,size:n,color:l,checked:u,disabled:i}=e,h={root:["root",s&&`edge${N(s)}`,`size${N(n)}`],switchBase:["switchBase",`color${N(l)}`,u&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m=V(h,Ye,t);return{...t,...m}},Qe=R("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.edge&&t[`edge${N(s.edge)}`],t[`size${N(s.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${f.thumb}`]:{width:16,height:16},[`& .${f.switchBase}`]:{padding:4,[`&.${f.checked}`]:{transform:"translateX(16px)"}}}}]}),Ze=R(Ae,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.switchBase,{[`& .${f.input}`]:t.input},s.color!=="default"&&t[`color${N(s.color)}`]]}})(z(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${f.checked}`]:{transform:"translateX(20px)"},[`&.${f.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${f.checked} + .${f.track}`]:{opacity:.5},[`&.${f.disabled} + .${f.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${f.input}`]:{left:"-100%",width:"300%"}})),z(({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:se(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(pe(["light"])).map(([t])=>({props:{color:t},style:{[`&.${f.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:se(e.palette[t].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${f.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${e.palette.mode==="light"?me(e.palette[t].main,.62):fe(e.palette[t].main,.55)}`}},[`&.${f.checked} + .${f.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]}))),et=R("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(z(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),tt=R("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(z(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),at=y.forwardRef(function(t,s){const n=Z({props:t,name:"MuiSwitch"}),{className:l,color:u="primary",edge:i=!1,size:h="medium",sx:m,...c}=n,d={...n,color:u,edge:i,size:h},g=Je(d),v=a.jsx(tt,{className:g.thumb,ownerState:d});return a.jsxs(Qe,{className:G(g.root,l),sx:m,ownerState:d,children:[a.jsx(Ze,{type:"checkbox",icon:v,checkedIcon:v,ref:s,ownerState:d,...c,classes:{...g,root:g.switchBase}}),a.jsx(et,{className:g.track,ownerState:d})]})}),de="/botc-notes/assets/coffin-BwzAi1KE.png",st="/botc-notes/assets/medical-bag-CRqNl0s0.png",ot="/botc-notes/assets/hand-back-right-D-O_6Yza.png",nt="/botc-notes/assets/hand-pointing-right-C39pANdg.png";function rt(e){const t=le(),s=e.state,n=_(o=>o.time.time),l=_(o=>o.players.players),[u,i]=y.useState(null),h=!!u;function m(o){i(o.currentTarget)}const[c,d]=y.useState(""),{getRole:g}=y.useContext(ge),v=_(o=>o.roles.roles.filter(p=>{var w;return((w=g(p))==null?void 0:w.canCauseDeath)??!1}));function F(o){d(o.target.value)}return a.jsxs("div",{id:"townsquare_center",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:[a.jsxs("div",{className:s===C.Default?"flex flex-col justify-center ":"hidden",children:[a.jsx(Ie,{value:[T.Time,n]}),a.jsx(E,{onClick:m,children:"Action"}),a.jsxs(ce,{open:h,onClose:()=>i(null),anchorEl:u,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"},children:[a.jsx(P,{onClick:()=>{t(be()),i(null)},children:"Move time forward"}),a.jsx(P,{onClick:()=>{e.setCurrentState(C.Nominator),e.setOverlayImage(nt),i(null)},children:"Nomination"}),a.jsx(P,{onClick:()=>{e.setCurrentState(C.Vote),e.setOverlayImage(ot),i(null)},children:"Vote"}),a.jsx(P,{onClick:()=>{e.setCurrentState(C.Life_and_Death),e.setOverlayImage(de),i(null)},children:"Life & Death"})]})]}),a.jsx("div",{className:s===C.Nominator?"":"hidden",children:a.jsx("p",{children:"Who nominated?"})}),a.jsx("div",{className:s===C.Nominee?"":"hidden",children:a.jsx("p",{children:"Who is nominated?"})}),a.jsxs("div",{className:s===C.Vote?"":"hidden",children:[a.jsx("p",{children:"Who is voting?"}),a.jsx(E,{onClick:()=>{const o=[];if(e.playerListCache.length===0)o.push("Nobody voted");else for(const[p,w]of e.playerListCache.entries())o.push([T.Player,w]),p!=e.playerListCache.length-1?o.push(", "):o.push(" voted.");t(Q({note:o})),e.setPlayerListCache([]),e.setOverlayImage(null),e.setCurrentState(C.Default)},children:a.jsx(U,{path:oe,size:1})})]}),a.jsxs("div",{className:s===C.Life_and_Death?"":"hidden",children:[a.jsx("p",{children:"Who died (or resuscitated)?"}),a.jsxs(Ne,{disabled:e.playerListCache.length==0||!l[e.playerListCache[0]].alive,children:[a.jsx(Re,{children:"Death reason:"}),a.jsxs($e,{labelId:"demo-simple-select-label",id:"death_reason",value:c,label:"Death Reason",onChange:F,children:[a.jsx(P,{value:" "}),a.jsx(P,{value:"execution",children:"Execution"}),v.map(o=>a.jsx(P,{value:o,children:o}))]}),a.jsxs("div",{className:"flex flex-row",children:[a.jsx(E,{onClick:()=>{if(e.playerListCache.length!==0){const p=["On",[T.Time,n],", ",[T.Player,e.playerListCache[0]]];if(l[e.playerListCache[0]].alive){var o="died";c==="execution"?(o+=" by execution.",p.push(o)):c===""?p.push(o):(o+=" by the ",p.push(o),p.push([T.Role,c]))}else p.push("came back to life");t(Q({note:p})),t(ve({index:e.playerListCache[0],alive:!l[e.playerListCache[0]].alive})),e.setPlayerListCache([]),e.setOverlayImage(null),d("")}e.setCurrentState(C.Default)},children:a.jsx(U,{path:oe,size:1})}),a.jsx(E,{onClick:()=>{e.setPlayerListCache([]),e.setOverlayImage(null),e.setCurrentState(C.Default)},children:a.jsx(U,{path:Le,size:1})})]})]})]})]})}var C=(e=>(e[e.Default=0]="Default",e[e.Nominator=1]="Nominator",e[e.Nominee=2]="Nominee",e[e.Vote=3]="Vote",e[e.Life_and_Death=4]="Life_and_Death",e))(C||{});function ut(){const e=le(),t=xe(),s=_(r=>r.time.time),n=_(r=>r.players.players),l=_(r=>r.settings.tutorialStage),u=[{target:"body",content:"This is the main game screen",placement:"center"},{target:"#note_list",content:"Here you can write notes of events",placement:"left"},{target:"#note_buttons",content:"Tap on those buttons to add, edit, or delete a note",placement:"bottom"},{target:"#townsquare_center",content:"Here you can see the current time as well as initiating actions such as moving to the next phase, nominations, voting, or marking people dead (or alive)"},{target:"#hide_button",content:"This button will let you hide information to fend off nosy players"},{target:"#top_menu",content:"This menu will let you reset the game and go back to setup (WARNING: it will reset EVERYTHING)"},{target:".token",content:"Those represent players, you can tap on them to see more details"}],i=r=>{const{action:x,status:b}=r;([J.CLOSE,J.STOP,J.SKIP].includes(x)||[ne.FINISHED,ne.SKIPPED].includes(b))&&e(ye({stage:2}))},[h,m]=y.useState(0),[c,d]=y.useState([]),[g,v]=y.useState(null);function F(r){switch(h){case 0:return t(`/play/player/${r}`);case 1:d([r]),m(2);break;case 2:const x=["On",[T.Time,s],", ",[T.Player,c[0]]," nominated ",[T.Player,r],""];e(Q({note:x})),d([]),v(null),m(0);break;case 3:const b=[...c];b.includes(r)?b.splice(b.indexOf(r),1):b.push(r),d(b);break;case 4:d([r]),v(n[r].alive?de:st);break}}const[o,p]=Ce.useState(null),w=!!o;function I(r){p(r.currentTarget)}function O(){we()}const[M,$]=y.useState(!1);return a.jsxs("div",{className:"h-dvh",children:[a.jsx(Pe,{steps:u,showSkipButton:!0,continuous:!0,callback:i,run:l<2}),a.jsx("div",{className:"flex flex-col lg:flex-row landscape:flex-row h-dvh w-screen",children:a.jsxs(Te,{hideInformation:M,playersWithOverlay:c,overlayImage:g,children:[a.jsxs("div",{className:"relative flex w-full h-3/5 lg:h-full landscape:h-full lg:w-3/5 landscape:w-3/5 justify-center",children:[a.jsx("div",{className:"relative aspect-square max-w-full",children:a.jsx(Be,{tapAction:r=>{F(r)},children:a.jsx(rt,{state:h,setCurrentState:m,setOverlayImage:v,playerListCache:c,setPlayerListCache:d})})}),a.jsx(Xe,{id:"hide_button",className:"absolute top-0 right-0",children:a.jsx(He,{control:a.jsx(at,{onChange:r=>{$(r.target.checked)}}),label:"Hide info",labelPlacement:"start",value:M})})]}),a.jsx("div",{id:"note_list",className:"basis-2/5 overflow-auto lg:max-h-screen landscape:max-h-screen",children:a.jsx(Me,{})}),a.jsxs("div",{id:"top_menu",className:"absolute top left",children:[a.jsx(E,{onClick:I,children:a.jsx(U,{path:Fe,size:1})}),a.jsx(ce,{anchorEl:o,open:w,onClose:()=>{p(null)},children:a.jsx(P,{onClick:O,children:"Reset game"})})]})]})})]})}export{C as PlayStates,ut as default};
