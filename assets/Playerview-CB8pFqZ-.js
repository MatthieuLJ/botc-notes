import{G as D,u as o,f as E,r as l,a as I,C as b,H as A,j as e,i as O}from"./index-CxuhX6vN.js";import{c as B,h as q,D as L,C as R,A as d,g as m}from"./index-CH32MFle.js";import{a as W}from"./NoteList-CSBqon0T.js";import{B as p}from"./mdi-CS1FVayI.js";import"./role-BNc36tb4.js";import"./listItemButtonClasses-BY19XGAX.js";function J(){const y=D(),a=parseInt(y.playerIndex??"0"),h=o(s=>s.players.players[a]),n=E(),u=o(s=>s.players.players.length),g=(a+1)%u,j=a-1<0?u-1:Number(a)-1,[w,i]=l.useState(!1),[r,C]=l.useState(h.claims),c=I(),v=[b.Player,a],S=o(s=>s.settings.tutorialStage),k=[{target:"#player_token",content:"This shows the current claim for that player, tap on the token to change them"},{target:"#note_list",content:"Those are the notes related to that player"}],N=s=>{const{action:t,status:T}=s;([d.CLOSE,d.STOP,d.SKIP].includes(t)||[m.FINISHED,m.SKIPPED].includes(T))&&c(O({stage:3}))},f=l.useRef(null),[_,P]=l.useState(0);function x(){const s=f.current;s!==null&&P(Math.max(100,s.clientWidth/3))}return l.useEffect(()=>{window.addEventListener("resize",x),x()},[]),l.useEffect(()=>{c(A({index:a,claims:r}))},[c,r]),e.jsxs("div",{className:"h-dvh",children:[e.jsx(B,{steps:k,showSkipButton:!0,continuous:!0,callback:N,run:S<3}),e.jsxs("div",{className:"flex flex-col lg:flex-row landscape:flex-row h-dvh  w-screen",children:[e.jsxs("div",{className:"flex flex-col w-full h-3/5 lg:h-full landscape:h-full lg:w-3/5 landscape:w-3/5",children:[e.jsxs("div",{className:"flex flex-grow w-full",ref:f,children:[e.jsx("div",{className:"basis-1/5 h-full content-center",children:e.jsx(p,{onClick:()=>{n(`/play/player/${j}`)},children:"Counter-clockwise"})}),e.jsx("div",{className:"basis-3/5 content-center",children:e.jsx("div",{id:"player_token",className:"flex w-full place-content-center h-fit",children:e.jsx(q,{index:a,tokenWidth:_,tapPlayer:()=>{i(!0)}})})}),e.jsx("div",{className:"basis-1/5 content-center",children:e.jsx(p,{onClick:()=>{n(`/play/player/${g}`)},children:"Clockwise"})})]}),e.jsx("div",{className:"h-fit",children:e.jsx(p,{id:"townsquare",name:"townsquare",onClick:()=>n("/play"),children:"Back to townsquare"})})]}),e.jsx("div",{id:"note_list",className:"basis-2/5 lg:max-h-screen landscape:max-h-screen",children:e.jsx(W,{filter:v})})]}),e.jsx(L,{open:w,onClose:()=>{i(!1)},children:e.jsx(R,{highlights:h.claims,tapCharacter:s=>{const t=[...r];t.includes(s)?t.splice(t.indexOf(s),1):t.push(s),C(t)},closeDialog:()=>{i(!1)}})})]})}export{J as default};
