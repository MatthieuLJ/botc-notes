import{D,u as o,f as E,r as l,a as I,C as b,E as A,j as e,h as O}from"./index-Okv8gMGM.js";import{c as B,B as d,l as q,D as L,C as R,A as p,k as m}from"./index-DoaENzwb.js";import{a as W}from"./NoteList-CemgqFmr.js";import"./role-BNc36tb4.js";function H(){const y=D(),a=parseInt(y.playerIndex??"0"),h=o(s=>s.players.players[a]),n=E(),u=o(s=>s.players.players.length),g=(a+1)%u,j=a-1<0?u-1:Number(a)-1,[w,i]=l.useState(!1),[c,C]=l.useState(h.claims),r=I(),v=[b.Player,a],k=o(s=>s.settings.tutorialStage),S=[{target:"#player_token",content:"This shows the current claim for that player, tap on the token to change them"},{target:"#note_list",content:"Those are the notes related to that player"}],N=s=>{const{action:t,status:T}=s;([p.CLOSE,p.STOP,p.SKIP].includes(t)||[m.FINISHED,m.SKIPPED].includes(T))&&r(O({stage:3}))},f=l.useRef(null),[_,P]=l.useState(0);function x(){const s=f.current;s!==null&&P(Math.max(100,s.clientWidth/3))}return l.useEffect(()=>{window.addEventListener("resize",x),x()},[]),l.useEffect(()=>{r(A({index:a,claims:c}))},[r,c]),e.jsxs("div",{className:"h-dvh",children:[e.jsx(B,{steps:S,showSkipButton:!0,continuous:!0,callback:N,run:k<3}),e.jsxs("div",{className:"flex flex-col lg:flex-row landscape:flex-row h-dvh  w-screen",children:[e.jsxs("div",{className:"flex flex-col w-full h-3/5 lg:h-full landscape:h-full lg:w-3/5 landscape:w-3/5",children:[e.jsxs("div",{className:"flex flex-grow w-full",ref:f,children:[e.jsx("div",{className:"basis-1/5 h-full content-center",children:e.jsx(d,{onClick:()=>{n(`/play/player/${j}`)},children:"Counter-clockwise"})}),e.jsx("div",{className:"basis-3/5 content-center",children:e.jsx("div",{id:"player_token",className:"flex w-full place-content-center h-fit",children:e.jsx(q,{index:a,tokenWidth:_,tapPlayer:()=>{i(!0)}})})}),e.jsx("div",{className:"basis-1/5 content-center",children:e.jsx(d,{onClick:()=>{n(`/play/player/${g}`)},children:"Clockwise"})})]}),e.jsx("div",{className:"h-fit",children:e.jsx(d,{id:"townsquare",name:"townsquare",onClick:()=>n("/play"),children:"Back to townsquare"})})]}),e.jsx("div",{id:"note_list",className:"basis-2/5 lg:max-h-screen landscape:max-h-screen",children:e.jsx(W,{filter:v})})]}),e.jsx(L,{open:w,onClose:()=>{i(!1)},children:e.jsx(R,{highlights:h.claims,tapCharacter:s=>{const t=[...c];t.includes(s)?t.splice(t.indexOf(s),1):t.push(s),C(t)},closeDialog:()=>{i(!1)}})})]})}export{H as default};
