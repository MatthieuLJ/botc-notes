import{k as H,l as V,m as R,n as pe,r as y,j as a,o as G,p as N,q as W,t as O,v as ee,w as oe,x as me,y as fe,z as ge,a as le,u as _,S as be,C as P,h as ve,g as Y,N as Z,A as xe,f as Ce,R as ye,i as we,B as ke,D as Se,E as je,F as Ne}from"./index-CxuhX6vN.js";import{u as Re,b as te,f as ce,d as $e,M as de,F as Te,e as Le,S as Pe,c as Be,P as Fe,T as De,A as Q,g as ne}from"./index-CH32MFle.js";import{T as re,N as Ie,M as L,a as Me}from"./NoteList-CSBqon0T.js";import{a as ze,B as z,I as U,b as ie,c as _e,d as Oe,e as Ae}from"./mdi-CS1FVayI.js";import"./role-BNc36tb4.js";import"./listItemButtonClasses-BY19XGAX.js";function Ee(e){return H("PrivateSwitchBase",e)}V("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const qe=e=>{const{classes:t,checked:s,disabled:n,edge:i}=e,u={root:["root",s&&"checked",n&&"disabled",i&&`edge${N(i)}`],input:["input"]};return W(u,Ee,t)},Ue=R(ze)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:t})=>e==="start"&&t.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:t})=>e==="end"&&t.size!=="small",style:{marginRight:-12}}]}),Ge=R("input",{shouldForwardProp:pe})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),He=y.forwardRef(function(t,s){const{autoFocus:n,checked:i,checkedIcon:u,className:l,defaultChecked:h,disabled:m,disableFocusRipple:c=!1,edge:d=!1,icon:g,id:v,inputProps:F,inputRef:o,name:p,onBlur:w,onChange:D,onFocus:A,readOnly:I,required:$=!1,tabIndex:r,type:x,value:b,...K}=t,[B,E]=Re({controlled:i,default:!!h,name:"SwitchBase",state:"checked"}),k=te(),X=j=>{A&&A(j),k&&k.onFocus&&k.onFocus(j)},M=j=>{w&&w(j),k&&k.onBlur&&k.onBlur(j)},T=j=>{if(j.nativeEvent.defaultPrevented)return;const se=j.target.checked;E(se),D&&D(j,se)};let S=m;k&&typeof S>"u"&&(S=k.disabled);const he=x==="checkbox"||x==="radio",J={...t,checked:B,disabled:S,disableFocusRipple:c,edge:d},ae=qe(J);return a.jsxs(Ue,{component:"span",className:G(ae.root,l),centerRipple:!0,focusRipple:!c,disabled:S,tabIndex:null,role:void 0,onFocus:X,onBlur:M,ownerState:J,ref:s,...K,children:[a.jsx(Ge,{autoFocus:n,checked:i,defaultChecked:h,className:ae.input,disabled:S,id:he?v:void 0,name:p,onChange:T,readOnly:I,ref:o,required:$,ownerState:J,tabIndex:r,type:x,...x==="checkbox"&&b===void 0?{}:{value:b},...F}),B?u:g]})});function Ve(e){return H("MuiFormControlLabel",e)}const q=V("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),We=e=>{const{classes:t,disabled:s,labelPlacement:n,error:i,required:u}=e,l={root:["root",s&&"disabled",`labelPlacement${N(n)}`,i&&"error",u&&"required"],label:["label",s&&"disabled"],asterisk:["asterisk",i&&"error"]};return W(l,Ve,t)},Ke=R("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[{[`& .${q.label}`]:t.label},t.root,t[`labelPlacement${N(s.labelPlacement)}`]]}})(O(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${q.disabled}`]:{cursor:"default"},[`& .${q.label}`]:{[`&.${q.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:t})=>t==="start"||t==="top"||t==="bottom",style:{marginLeft:16}}]}))),Xe=R("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})(O(({theme:e})=>({[`&.${q.error}`]:{color:(e.vars||e).palette.error.main}}))),Je=y.forwardRef(function(t,s){const n=ee({props:t,name:"MuiFormControlLabel"}),{checked:i,className:u,componentsProps:l={},control:h,disabled:m,disableTypography:c,inputRef:d,label:g,labelPlacement:v="end",name:F,onChange:o,required:p,slots:w={},slotProps:D={},value:A,...I}=n,$=te(),r=m??h.props.disabled??($==null?void 0:$.disabled),x=p??h.props.required,b={disabled:r,required:x};["checked","name","onChange","value","inputRef"].forEach(S=>{typeof h.props[S]>"u"&&typeof n[S]<"u"&&(b[S]=n[S])});const K=ce({props:n,muiFormControl:$,states:["error"]}),B={...n,disabled:r,labelPlacement:v,required:x,error:K.error},E=We(B),k={slots:w,slotProps:{...l,...D}},[X,M]=$e("typography",{elementType:re,externalForwardedProps:k,ownerState:B});let T=g;return T!=null&&T.type!==re&&!c&&(T=a.jsx(X,{component:"span",...M,className:G(E.label,M==null?void 0:M.className),children:T})),a.jsxs(Ke,{className:G(E.root,u),ownerState:B,ref:s,...I,children:[y.cloneElement(h,b),x?a.jsxs("div",{children:[T,a.jsxs(Xe,{ownerState:B,"aria-hidden":!0,className:E.asterisk,children:["â€‰","*"]})]}):T]})});function Qe(e){return H("MuiFormGroup",e)}V("MuiFormGroup",["root","row","error"]);const Ye=e=>{const{classes:t,row:s,error:n}=e;return W({root:["root",s&&"row",n&&"error"]},Qe,t)},Ze=R("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.row&&t.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),et=y.forwardRef(function(t,s){const n=ee({props:t,name:"MuiFormGroup"}),{className:i,row:u=!1,...l}=n,h=te(),m=ce({props:n,muiFormControl:h,states:["error"]}),c={...n,row:u,error:m.error},d=Ye(c);return a.jsx(Ze,{className:G(d.root,i),ownerState:c,ref:s,...l})});function tt(e){return H("MuiSwitch",e)}const f=V("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),at=e=>{const{classes:t,edge:s,size:n,color:i,checked:u,disabled:l}=e,h={root:["root",s&&`edge${N(s)}`,`size${N(n)}`],switchBase:["switchBase",`color${N(i)}`,u&&"checked",l&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m=W(h,tt,t);return{...t,...m}},st=R("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.edge&&t[`edge${N(s.edge)}`],t[`size${N(s.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${f.thumb}`]:{width:16,height:16},[`& .${f.switchBase}`]:{padding:4,[`&.${f.checked}`]:{transform:"translateX(16px)"}}}}]}),ot=R(He,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.switchBase,{[`& .${f.input}`]:t.input},s.color!=="default"&&t[`color${N(s.color)}`]]}})(O(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${f.checked}`]:{transform:"translateX(20px)"},[`&.${f.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${f.checked} + .${f.track}`]:{opacity:.5},[`&.${f.disabled} + .${f.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${f.input}`]:{left:"-100%",width:"300%"}})),O(({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:oe(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(me(["light"])).map(([t])=>({props:{color:t},style:{[`&.${f.checked}`]:{color:(e.vars||e).palette[t].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[t].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:oe(e.palette[t].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${f.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${t}DisabledColor`]:`${e.palette.mode==="light"?fe(e.palette[t].main,.62):ge(e.palette[t].main,.55)}`}},[`&.${f.checked} + .${f.track}`]:{backgroundColor:(e.vars||e).palette[t].main}}}))]}))),nt=R("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(O(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),rt=R("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(O(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),it=y.forwardRef(function(t,s){const n=ee({props:t,name:"MuiSwitch"}),{className:i,color:u="primary",edge:l=!1,size:h="medium",sx:m,...c}=n,d={...n,color:u,edge:l,size:h},g=at(d),v=a.jsx(rt,{className:g.thumb,ownerState:d});return a.jsxs(st,{className:G(g.root,i),sx:m,ownerState:d,children:[a.jsx(ot,{type:"checkbox",icon:v,checkedIcon:v,ref:s,ownerState:d,...c,classes:{...g,root:g.switchBase}}),a.jsx(nt,{className:g.track,ownerState:d})]})}),ue="/botc-notes/assets/coffin-BwzAi1KE.png",lt="/botc-notes/assets/medical-bag-CRqNl0s0.png",ct="/botc-notes/assets/hand-back-right-D-O_6Yza.png",dt="/botc-notes/assets/hand-pointing-right-C39pANdg.png";function ut(e){const t=le(),s=e.state,n=_(o=>o.time.time),i=_(o=>o.players.players),[u,l]=y.useState(null),h=!!u;function m(o){l(o.currentTarget)}const[c,d]=y.useState(""),{getRole:g}=y.useContext(be),v=_(o=>o.roles.roles.filter(p=>{var w;return((w=g(p))==null?void 0:w.canCauseDeath)??!1}));function F(o){d(o.target.value)}return a.jsxs("div",{id:"townsquare_center",className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:[a.jsxs("div",{className:s===C.Default?"flex flex-col justify-center ":"hidden",children:[a.jsx(Ie,{value:[P.Time,n]}),a.jsx(z,{onClick:m,children:"Action"}),a.jsxs(de,{open:h,onClose:()=>l(null),anchorEl:u,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"},children:[a.jsx(L,{onClick:()=>{t(ve()),l(null)},children:"Move time forward"},"time"),a.jsx(L,{disabled:n%2===0,onClick:()=>{e.setCurrentState(C.Nominator),e.setOverlayImage(dt),l(null)},children:"Nomination"},"nomination"),a.jsx(L,{disabled:n%2===0,onClick:()=>{e.setCurrentState(C.Vote),e.setOverlayImage(ct),l(null)},children:"Vote"},"vote"),a.jsx(L,{onClick:()=>{e.setCurrentState(C.Life_and_Death),e.setOverlayImage(ue),l(null)},children:"Life & Death"},"lifendeath")]})]}),a.jsx("div",{className:s===C.Nominator?"":"hidden",children:a.jsx("p",{children:"Who nominated?"})}),a.jsx("div",{className:s===C.Nominee?"":"hidden",children:a.jsx("p",{children:"Who is nominated?"})}),a.jsxs("div",{className:s===C.Vote?"":"hidden",children:[a.jsx("p",{children:"Who is voting?"}),a.jsx(z,{onClick:()=>{const o=[];if(e.playerListCache.length===0)o.push("Nobody voted");else for(const[p,w]of e.playerListCache.entries())o.push([P.Player,w]),p!=e.playerListCache.length-1?o.push(", "):o.push(" voted.");t(Y({note:o,tag:Z.Vote})),e.setPlayerListCache([]),e.setOverlayImage(null),e.setCurrentState(C.Default)},children:a.jsx(U,{path:ie,size:1})})]}),a.jsxs("div",{className:s===C.Life_and_Death?"":"hidden",children:[a.jsx("p",{children:"Who died (or resuscitated)?"}),a.jsxs(Te,{disabled:e.playerListCache.length==0||!i[e.playerListCache[0]].alive,children:[a.jsx(Le,{children:"Death reason:"}),a.jsxs(Pe,{labelId:"demo-simple-select-label",id:"death_reason",value:c,label:"Death Reason",onChange:F,children:[a.jsx(L,{value:" "}),a.jsx(L,{value:"execution",children:"Execution"}),v.map(o=>a.jsx(L,{value:o,children:o}))]}),a.jsxs("div",{className:"flex flex-row",children:[a.jsx(z,{onClick:()=>{if(e.playerListCache.length!==0){const p=["On",[P.Time,n],", ",[P.Player,e.playerListCache[0]]];if(i[e.playerListCache[0]].alive){var o="died";c==="execution"?(o+=" by execution.",p.push(o)):c===""?p.push(o):(o+=" by the ",p.push(o),p.push([P.Role,c]))}else p.push("came back to life");t(Y({note:p,tag:Z.LifeDeath})),t(xe({index:e.playerListCache[0],alive:!i[e.playerListCache[0]].alive})),e.setPlayerListCache([]),e.setOverlayImage(null),d("")}e.setCurrentState(C.Default)},children:a.jsx(U,{path:ie,size:1})}),a.jsx(z,{onClick:()=>{e.setPlayerListCache([]),e.setOverlayImage(null),e.setCurrentState(C.Default)},children:a.jsx(U,{path:_e,size:1})})]})]})]})]})}var C=(e=>(e[e.Default=0]="Default",e[e.Nominator=1]="Nominator",e[e.Nominee=2]="Nominee",e[e.Vote=3]="Vote",e[e.Life_and_Death=4]="Life_and_Death",e))(C||{});function vt(){const e=le(),t=Ce(),s=_(r=>r.time.time),n=_(r=>r.players.players),i=_(r=>r.settings.tutorialStage),u=[{target:"body",content:"This is the main game screen",placement:"center"},{target:"#note_list",content:"Here you can write notes of events",placement:"left"},{target:"#note_buttons",content:"Tap on those buttons to add, edit, or delete a note",placement:"bottom"},{target:"#townsquare_center",content:"Here you can see the current time as well as initiating actions such as moving to the next phase, nominations, voting, or marking people dead (or alive)"},{target:"#hide_button",content:"This button will let you hide information to fend off nosy players"},{target:"#top_menu",content:"This menu will let you reset the game and go back to setup, it will keep the current players names and seatings"},{target:"#timeline",content:"This button will show you a timeline with only information about nominations, votes, and life/death of players for each day"},{target:".token",content:"Those represent players, you can tap on them to see more details"}],l=r=>{const{action:x,status:b}=r;([Q.CLOSE,Q.STOP,Q.SKIP].includes(x)||[ne.FINISHED,ne.SKIPPED].includes(b))&&e(we({stage:2}))},[h,m]=y.useState(0),[c,d]=y.useState([]),[g,v]=y.useState(null);function F(r){switch(h){case 0:return t(`/play/player/${r}`);case 1:d([r]),m(2);break;case 2:const x=["On",[P.Time,s],", ",[P.Player,c[0]]," nominated ",[P.Player,r],""];e(Y({note:x,tag:Z.Nomination})),d([]),v(null),m(0);break;case 3:const b=[...c];b.includes(r)?b.splice(b.indexOf(r),1):b.push(r),d(b);break;case 4:d([r]),v(n[r].alive?ue:lt);break}}const[o,p]=ye.useState(null),w=!!o;function D(r){p(r.currentTarget)}function A(){e(ke()),e(Se()),e(je()),e(Ne())}const[I,$]=y.useState(!1);return a.jsxs("div",{className:"h-dvh",children:[a.jsx(Be,{steps:u,showSkipButton:!0,continuous:!0,callback:l,run:i<2}),a.jsx("div",{className:"flex flex-col lg:flex-row landscape:flex-row h-dvh w-screen",children:a.jsxs(Fe,{hideInformation:I,playersWithOverlay:c,overlayImage:g,children:[a.jsxs("div",{className:"relative flex w-full h-3/5 lg:h-full landscape:h-full lg:w-3/5 landscape:w-3/5 justify-center",children:[a.jsx("div",{className:"relative aspect-square max-w-full",children:a.jsx(De,{tapAction:r=>{F(r)},children:a.jsx(ut,{state:h,setCurrentState:m,setOverlayImage:v,playerListCache:c,setPlayerListCache:d})})}),a.jsx(et,{id:"hide_button",className:"absolute top-0 right-0",children:a.jsx(Je,{control:a.jsx(it,{onChange:r=>{$(r.target.checked)}}),label:"Hide info",labelPlacement:"start",value:I})}),a.jsx("div",{id:"timeline",className:"absolute bottom-0 left-0",children:a.jsx(z,{onClick:()=>t("/play/timeline"),children:a.jsx(U,{path:Oe,size:1})})})]}),a.jsx("div",{id:"note_list",className:"basis-2/5 overflow-auto lg:max-h-screen landscape:max-h-screen",children:a.jsx(Me,{})}),a.jsxs("div",{id:"top_menu",className:"absolute top left",children:[a.jsx(z,{onClick:D,children:a.jsx(U,{path:Ae,size:1})}),a.jsx(de,{anchorEl:o,open:w,onClose:()=>{p(null)},children:a.jsx(L,{onClick:A,children:"Reset game"})})]})]})})]})}export{C as PlayStates,vt as default};
